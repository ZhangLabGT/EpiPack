Search.setIndex({"docnames": ["clustering_tutorial", "data_preparation", "index", "install", "reference_mapping", "tutorials"], "filenames": ["clustering_tutorial.ipynb", "data_preparation.ipynb", "index.rst", "install.rst", "reference_mapping.ipynb", "tutorials.rst"], "titles": ["Step 1: Peak pretrain (clustering)", "Data preparation", "Welcome to EpiPack\u2019s documentation!", "Installation guide", "Reference mapping with PEIVI", "Tutorials"], "terms": {"epipackpi": [0, 1, 2, 3, 4], "implement": [], "comput": [0, 1], "framework": [], "singl": 2, "cell": [0, 1, 2, 4], "atac": 2, "seq": [1, 2], "data": [], "integr": [0, 1, 4], "refer": [1, 2, 3], "map": [0, 1, 2], "type": [2, 4], "annot": [1, 4], "leverag": [], "heterogen": [], "transfer": [2, 4], "learn": 4, "accept": [], "gene": 4, "activ": 1, "score": 4, "matrix": [0, 4], "bridg": 0, "peak": 4, "embed": [0, 4], "sourc": [], "inform": [], "multi": [], "batch": [0, 1, 4], "construct": [1, 2, 4], "atla": [], "label": [2, 4], "common": [], "latent": [1, 4], "space": 4, "without": [], "align": 1, "To": [1, 2, 4], "get": [2, 4], "start": [0, 1, 2], "check": [2, 3], "out": [0, 1, 2], "instal": [0, 1, 2, 4], "guid": 2, "tutori": [0, 1, 2, 3, 4], "The": [0, 1, 2, 3, 4], "can": [0, 1, 3, 4], "via": [0, 3, 4], "pip": [0, 1, 3, 4], "us": [0, 1, 3, 4], "follow": [0, 1, 3, 4], "command": 3, "For": [1, 3], "gpu": [0, 1, 3, 4], "base": [0, 1, 3], "pytorch": 3, "we": [0, 1, 3, 4], "recommend": [1, 3], "torch": 3, "portal": 3, "after": [0, 1, 3, 4], "cuda": 3, "version": [0, 3], "nvidia": 3, "smi": 3, "now": 3, "you": [3, 4], "ar": [1, 3, 4], "all": [1, 3], "set": [0, 3, 4], "how": [1, 3], "tbd": 5, "1": 4, "import": [0, 1, 4], "panda": [0, 1, 4], "pd": [0, 1, 4], "numpi": [0, 1, 4], "np": [0, 1, 4], "scanpi": [0, 1, 4], "sc": [0, 1, 4], "anndata": [0, 1, 4], "dataload": [], "epi": [], "scib_metr": [], "from": [0, 1, 4], "benchmark": 4, "scvi": [], "importlib": [], "epipack": [1, 4], "epk": [0, 1, 2, 4], "vae_vamp_gmm": [], "vae_common": [], "nethom": [0, 1, 4], "ycheng430": [0, 1, 4], "miniconda3": [0, 1, 4], "env": [0, 1, 4], "lib": [0, 1, 4], "python3": [0, 1, 4], "9": [0, 1, 4], "site": [0, 1, 4], "packag": [0, 1, 2, 4], "_set": [], "py": [0, 1, 4], "63": [], "userwarn": [0, 4], "sinc": [0, 4], "v1": [], "0": [0, 1, 4], "tool": 1, "longer": [], "random": [], "seed": [], "default": 0, "run": [], "reproduc": [], "result": 1, "previou": [], "self": [], "70": [], "dl_pin_memory_gpu_train": [], "i": [0, 1, 2, 4], "deprec": [0, 4], "remov": [], "pleas": [0, 4], "pass": [], "pin_memori": [], "loader": [], "instead": [], "tqdm": [0, 4], "auto": [0, 1, 4], "21": [0, 4], "tqdmwarn": [0, 4], "iprogress": [0, 4], "found": [0, 1, 4], "updat": [0, 4], "jupyt": [0, 4], "ipywidget": [0, 4], "see": [0, 4], "http": [0, 4], "readthedoc": [0, 4], "io": [0, 4], "en": [0, 4], "stabl": [0, 4], "user_instal": [0, 4], "html": [0, 4], "autonotebook": [0, 4], "notebook_tqdm": [0, 4], "flax": [], "struct": [], "132": [], "futurewarn": 0, "jax": [], "tree_util": [], "register_keypath": [], "futur": [0, 4], "releas": 4, "register_pytree_with_kei": [], "data_clz": [], "keypath": [], "2": [0, 4], "read_h5ad": 4, "cerebrum_batch_1": [], "h5ad": [1, 4], "compat": [], "__init__": [], "229": [], "move": [], "element": [], "un": [], "39": [0, 1, 4], "neighbor": [0, 4], "distanc": [], "obsp": [], "thi": [0, 1, 4], "where": [], "adjac": [], "matric": [], "should": 1, "go": [], "warn": 0, "3": [0, 1, 4], "x": [0, 1, 4], "raw": [0, 4], "4": [0, 1, 4], "sklearn": [], "preprocess": 1, "sp": [], "min_cel": [0, 1], "int": [0, 1, 4], "shape": [0, 1], "01": 4, "pp": [0, 1, 4], "filter_gen": [0, 1], "binar": [], "5": [0, 1, 4], "object": [0, 1, 4], "n_ob": [0, 1], "n_var": [0, 1], "20680": [], "40174": [], "ob": [1, 4], "orig": [], "ident": [], "ncount_rna": [], "nfeature_rna": [], "sample_nam": [], "donor_id": [], "day_of_pregn": [], "sex": [], "tissu": [], "total": [], "total_dedupl": [], "total_deduplicated_peak": [], "total_deduplicated_tss": [], "frip": [], "frit": [], "x_chrom_window_count": [], "y_chrom_window_count": [], "autosome_window_count": [], "blacklist_fract": [], "rna_snn_r": [], "seurat_clust": [], "ncount_peak": [], "nfeature_peak": [], "tissue_umap_1": [], "tissue_umap_2": [], "cell_typ": [], "peaks_snn_r": [], "8": [0, 4], "var": [0, 1], "count": [0, 1, 4], "percentil": [], "n_cell": [], "obsm": [0, 1, 4], "x_lsi": [], "x_tsne": [], "x_umap": [], "varm": [], "6": [0, 4], "pretrain_peak_model": [0, 1], "ml": [0, 1, 4], "peak_model": [0, 1], "count_enhanc": [0, 1], "todens": [0, 1], "z_dim": [], "50": 4, "batch_siz": [], "512": [], "layer_num": [], "region_factor": [], "fals": [1, 4], "model": [], "initi": [0, 1, 4], "detect": [0, 1, 2, 4], "detetc": [0, 1, 4], "mode": [0, 1, 4], "intial": [0, 1], "complet": [0, 1, 4], "7": [0, 1], "train_model": [0, 1, 4], "nepoch": [0, 1, 4], "200": [0, 1], "z": 0, "get_z": [0, 1], "epipack_z_bc": 4, "detach": [0, 1], "cpu": 0, "epoch": [0, 1, 4], "100": [0, 1, 4], "10": [0, 1, 4], "lt": [0, 1, 4], "00": [0, 1, 4], "05": [0, 1], "loss_val": [0, 1], "741": [], "28": [], "n_neighbor": 4, "use_rep": [0, 4], "tl": [0, 4], "umap": [0, 4], "leiden": [0, 4], "resolut": 4, "pl": [0, 1, 4], "color": [0, 4], "ncol": 4, "wspace": 4, "plot": [0, 4], "_tool": [0, 4], "scatterplot": [0, 4], "392": 4, "No": [0, 4], "colormap": [0, 4], "provid": [0, 1, 4], "c": [0, 1, 4], "paramet": [0, 4], "cmap": [0, 4], "ignor": [0, 4], "cax": [0, 4], "scatter": [0, 4], "celltyp": 4, "read_csv": 1, "cerebrum_batch_1_celltyp": [], "csv": 1, "list": [], "11": [0, 4], "30": [], "nmi_ari_cluster_labels_leiden": [], "connect": [], "optimize_resolut": [], "true": [1, 4], "n_job": [], "nmi": [], "5841662268804542": [], "ari": [], "4483450889309464": [], "31": [], "silhouette_label": [], "rescal": [], "chunk_siz": [], "256": [], "5194529201835394": [], "32": [], "clisi_knn": [], "perplex": [], "none": 0, "scale": [], "9999999829701015": [], "12": 0, "dataset": [1, 4], "13": [0, 4], "peakvi_test": [], "copi": [], "14": [], "setup_anndata": [], "pvi": [], "train": [], "tpu": [], "fall": [], "back": [], "tf_cpp_min_log_level": [], "rerun": [], "more": 1, "info": [], "avail": [], "core": [2, 4], "ipu": [], "hpu": [], "devic": [], "a40": [], "ha": 4, "tensor": [], "properli": [], "util": 4, "them": 4, "set_float32_matmul_precis": [], "medium": [], "high": [], "which": 1, "trade": [], "off": [], "precis": [], "perform": 4, "detail": 1, "read": 1, "org": [], "doc": [], "gener": [0, 1], "local_rank": [], "cuda_visible_devic": [], "122": [], "500": [], "24": [], "09": [], "57": 4, "89": [], "v_num": [], "train_loss_step": [], "3e": [], "train_loss_epoch": [], "02e": [], "monitor": [], "metric": 1, "reconstruction_loss_valid": [], "did": [], "improv": [], "last": [], "record": [], "best": [], "5341": [], "286": [], "signal": [], "trainer": [], "stop": [], "15": 4, "peakvi_latent_kei": [], "x_peakvi": [], "get_latent_represent": [], "16": 4, "17": 4, "biocon": [], "bioconserv": [], "isolated_label": [], "nmi_ari_cluster_labels_kmean": [], "18": [1, 4], "leiden_color": [], "cell_type_color": [], "27": [], "5750130693628137": [], "32586283762289403": [], "33": [], "5407780930399895": [], "43": [], "scbassset_test": [], "44": [], "chr": [], "end": 2, "var_nam": [], "split": [], "append": [], "45": [], "add_dna_sequ": [], "chr_var_kei": [], "start_var_kei": [], "end_var_kei": [], "genome_nam": [], "hg38": 1, "genome_dir": [], "work": 4, "23": [], "39it": [], "": 4, "46": [], "bdata": [], "transpos": [], "layer": 0, "binari": [0, 1], "astyp": 4, "float": [], "extern": 1, "dna_code_kei": [], "dna_cod": [], "column": [], "name": [1, 4], "adata": 4, "47": [], "48": [], "lightn": [], "fabric": [], "connector": [], "554": [], "support": [], "histor": [], "reason": 4, "its": 1, "usag": [], "discourag": [], "your": [], "mix": [], "rank_zero_warn": [], "16bit": [], "automat": [], "amp": [], "1000": [], "36": [1, 4], "04": 1, "271": [], "266": [], "fit": [], "max_epoch": [], "reach": [], "x_scbasset": [], "51": [], "52": 0, "53": [], "502081417500375": [], "2452450043638394": [], "54": [], "46758614107966423": [], "55": [], "pca": [], "x_pca": [], "pc": [], "56": [], "write_h5ad": 1, "cerebrum_result_1028": [], "pynndesc": 4, "pynndescent_": 4, "358": 4, "numbapendingdeprecationwarn": 4, "old_styl": 4, "error": 4, "captur": 4, "replac": 4, "new_styl": 4, "nn_descent_internal_low_memory_parallel": 4, "370": 4, "nn_descent_internal_high_memory_parallel": 4, "numba": 4, "function": [0, 2, 4], "310": 4, "use_new_style_error": 4, "nearestneighbor": [], "data_c0": [], "4444x4444": [], "spars": [], "class": [], "float64": [], "gt": [], "36113": [], "store": 0, "compress": [], "row": 1, "format": [0, 1], "In": [0, 1, 4], "introduc": [0, 1], "befor": [0, 1, 4], "appli": 0, "10x": [0, 1], "human": 0, "pbmc": [0, 1, 4], "an": [0, 1], "exampl": [0, 1], "also": [0, 1, 4], "dimens": 0, "reduct": 0, "independ": 0, "upgrad": [0, 1, 4], "__version__": [0, 1, 4], "0dev5": 0, "first": [0, 1, 4], "need": [0, 1, 4], "structur": 0, "file": [0, 1], "convert": [0, 1], "make_binari": [0, 1], "here": 0, "directli": 0, "h5": [0, 1], "genom": [0, 1], "cellrang": 0, "peak_1": [0, 1, 4], "dt": [0, 1], "read_10x_h5": [0, 1], "pbmc_batch": [0, 1, 4], "pbmc_10k_nextgem": [0, 4], "atac_pbmc_10k_nextgem_filtered_peak_bc_matrix": 0, "variabl": 0, "9688": 0, "144023": 0, "gene_id": [0, 1], "feature_typ": [0, 1], "autoencod": [0, 1], "same": [0, 1], "filter": [0, 1], "process": [0, 1], "peakvi": [0, 1], "rare": [0, 1], "make": [0, 1, 4], "faster": [0, 1], "print": [0, 1, 4], "region": [0, 1], "threshold": [0, 1], "place": [0, 1], "36728": 0, "next": [0, 1], "obtain": [0, 1, 4], "specif": [0, 1], "If": [0, 1], "dens": [0, 1], "input": [0, 1, 4], "03": 0, "07e": 0, "ani": 0, "other": [0, 1], "downstream": 0, "analysi": [0, 2], "extract": [0, 1], "z_epipack": [0, 1], "Then": [0, 4], "test": 0, "1251": 0, "valu": 0, "na_act": 0, "categor": [0, 4], "chang": 0, "desir": 0, "avoid": 0, "color_vector": 0, "color_map": 0, "394": 0, "python": [1, 2], "includ": 2, "oor": [2, 4], "state": [2, 4], "under": 2, "diseas": 2, "perturb": 2, "condit": 2, "consist": [1, 2, 4], "three": [2, 4], "main": [2, 4], "compon": 2, "peivi": [1, 2], "queri": [1, 2], "classifi": 2, "global": 2, "detector": 2, "local": 2, "variou": 2, "togeth": 1, "requir": [1, 4], "build": 1, "mappabl": 1, "subsequ": 1, "load": [1, 4], "1dev4": [1, 4], "either": 1, "both": [1, 4], "effici": 1, "flexibl": 1, "workflow": 1, "scatac": 1, "while": [1, 4], "archr": 1, "purpos": 1, "somewhat": 1, "lower": 1, "compar": 1, "put": 1, "r": 1, "code": [1, 4], "qualiti": 1, "control": 1, "below": 1, "websit": 1, "librari": 1, "seurat": 1, "genomeinfodb": 1, "ensdb": 1, "hsapien": 1, "v86": 1, "read10x_h5": 1, "filenam": 1, "atac_pbmc_5k_nextgem_filtered_peak_bc_matrix": 1, "metadata": 1, "atac_pbmc_5k_nextgem_singlecel": 1, "header": 1, "chrom_assai": 1, "createchromatinassai": 1, "sep": 1, "fragment": 1, "atac_pbmc_5k_nextgem_frag": 1, "tsv": 1, "gz": 1, "min": 1, "featur": 1, "createseuratobject": 1, "assai": 1, "meta": 1, "getgrangesfromensdb": 1, "seqlevelsstyl": 1, "ucsc": 1, "geneact": 1, "write": 1, "t": 1, "pbmc_10k_geneact": 1, "col": 1, "genescor": 1, "snap": 1, "import_data": 1, "pbmc_5k_nextgem": [1, 4], "chrom_siz": 1, "option": 1, "sorted_by_barcod": 1, "tsse": 1, "interact": 1, "filter_cel": 1, "min_tss": 1, "min_count": 1, "5000": 1, "gene_matrix": 1, "make_gene_matrix": 1, "_core": [1, 4], "121": 1, "implicitmodificationwarn": 1, "transform": 1, "str": 1, "index": 1, "4565": 1, "60606": 1, "n_fragment": 1, "frac_dup": 1, "frac_mito": 1, "step": [1, 4], "toolkit": 1, "e": 1, "g": 1, "bed": 1, "contain": 1, "ensur": 1, "guarante": 1, "barcod": 1, "those": 1, "4623": 1, "135377": 1, "between": 1, "common_cel": 1, "obs_nam": 1, "intersect": 1, "encod": [1, 4], "19": [1, 4], "38749": 1, "20": 1, "150": 1, "02": [1, 4], "55e": 1, "save": [1, 4], "repeat": 1, "one": 1, "22": 1, "edit_your_path": 1, "well": 4, "each": 4, "emploi": 4, "five": 4, "design": 4, "two": 4, "peak_2": 4, "peak_3": 4, "pbmc_10k_chromiumx": 4, "peak_4": 4, "pbmc_10k_chromium_control": 4, "peak_5": 4, "pbmc_multiom": 4, "peak_6": 4, "genescore_mtx": 4, "pbmc_5b_genemtx": 4, "ref1": 4, "batch_id": 4, "ref2": 4, "ref3": 4, "ref": 4, "concat": 4, "query_1": 4, "query_2": 4, "1838": 4, "observ": 4, "uniqu": 4, "call": 4, "obs_names_make_uniqu": 4, "warn_names_dupl": 4, "34": 4, "normal": 4, "express": 4, "normalize_tot": 4, "target_sum": 4, "1e4": 4, "log1p": 4, "along": 4, "concaten": 4, "procedur": 4, "across": 4, "begin": 4, "batch_cod": 4, "peak_emb": 4, "axi": 4, "epk_bas": 4, "reg_mmd": 4, "reg_rec": 4, "reg_z_l2": 4, "use_batch_norm": 4, "use_layer_norm": 4, "pre_train_epoch": 4, "z_ref": 4, "get_lat": 4, "val_kl_loss": 4, "96e": 4, "val_loss_z_dist": 4, "25": 4, "val_mmd": 4, "176": 4, "val_rec_loss": 4, "93e": 4, "mai": 4, "pickl": 4, "modul": 4, "pre": 4, "open": 4, "epk_model": 4, "pkl": 4, "wb": 4, "f": 4, "dump": 4, "rb": 4, "epi_integration_load": 4, "pretrain": 4, "creat": 4, "addit": 4, "serv": 4, "distribut": 4, "baselin": 4, "epk_queri": 4, "peivi_map": 4, "promoter_dt": 4, "enhancer_z": 4, "ref_embed": 4, "reg_mmd_int": 4, "query_model_initi": 4, "query_model": 4, "state_dict": 4, "query_batch_num": 4, "z_queri": 4, "58": 4, "78": 4, "97e": 4, "0382": 4, "val_mmd_int": 4, "0511": 4, "81e": 4, "further": 4, "discov": 4, "been": 4, "curat": 4, "seaborn": 4, "sn": 4, "set_figure_param": 4, "figsiz": 4, "frameon": 4, "set_them": 4, "tmp": 4, "z_tmp": 4, "346": 4, "init_rp_tre": 4, "dist": 4, "current_graph": 4, "leaf_arrai": 4, "348": 4, "init_random": 4, "rng_state": 4, "right": 4, "panel": 4, "cluster": 4, "remain": 4, "clearli": 4, "separ": 4}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"welcom": 2, "epipack": 2, "": 2, "document": 2, "instal": 3, "guid": 3, "main": 3, "packag": 3, "tutori": 5, "cluster": 0, "peakvi": [], "scbasset": [], "lsi": [], "step": 0, "1": [0, 1], "peak": [0, 1], "pretrain": 0, "read": 0, "data": [0, 1, 4], "preprocess": 0, "model": [0, 1, 4], "train": [0, 1, 4], "visual": [0, 4], "latent": 0, "space": 0, "prepar": 1, "creat": 1, "gene": 1, "score": 1, "matrix": 1, "signac": 1, "snapatac2": 1, "2": 1, "embed": 1, "get": 1, "refer": 4, "map": 4, "peivi": 4, "queri": 4, "option": 4}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"Step 1: Peak pretrain (clustering)": [[0, "Step-1:-Peak-pretrain-(clustering)"]], "Read data and preprocessing": [[0, "Read-data-and-preprocessing"]], "Model training": [[0, "Model-training"], [1, "Model-training"], [4, "Model-training"]], "Visualizing the latent space": [[0, "Visualizing-the-latent-space"]], "Tutorials": [[5, "tutorials"]], "Installation guide": [[3, "installation-guide"]], "Main package": [[3, "main-package"]], "Data preparation": [[1, "Data-preparation"]], "1. Create gene score matrix": [[1, "1.-Create-gene-score-matrix"]], "Signac": [[1, "Signac"]], "snapATAC2": [[1, "snapATAC2"]], "2. Create peak embedding": [[1, "2.-Create-peak-embedding"]], "get the peak embedding": [[1, "get-the-peak-embedding"]], "Welcome to EpiPack\u2019s documentation!": [[2, "welcome-to-epipack-s-documentation"]], "Reference mapping with PEIVI": [[4, "Reference-mapping-with-PEIVI"]], "Query mapping": [[4, "Query-mapping"]], "[Optional] Data visualization": [[4, "[Optional]-Data-visualization"]]}, "indexentries": {}})