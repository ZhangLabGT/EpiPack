Search.setIndex({"docnames": ["cell_label_transfer", "clustering_tutorial", "data_preparation", "index", "install", "reference_mapping", "tutorials"], "filenames": ["cell_label_transfer.ipynb", "clustering_tutorial.ipynb", "data_preparation.ipynb", "index.rst", "install.rst", "reference_mapping.ipynb", "tutorials.rst"], "titles": ["Cell label transfer on PEIVI mappiing space", "Step 1: Peak pretrain (clustering)", "Data preparation", "Welcome to EpiPack\u2019s documentation!", "Installation guide", "Reference mapping with PEIVI", "Tutorials"], "terms": {"epipackpi": [0, 1, 2, 3, 4, 5], "implement": [], "comput": [1, 2], "framework": [], "singl": 3, "cell": [1, 2, 3, 5], "atac": 3, "seq": [2, 3], "data": 0, "integr": [1, 2, 5], "refer": [0, 2, 3, 4], "map": [0, 1, 2, 3], "type": [0, 3, 5], "annot": [0, 2, 5], "leverag": [], "heterogen": [], "transfer": [3, 5], "learn": 5, "accept": [], "gene": 5, "activ": 2, "score": 5, "matrix": [0, 1, 5], "bridg": 1, "peak": 5, "embed": [0, 1, 5], "sourc": [], "inform": [], "multi": [], "batch": [1, 2, 5], "construct": [2, 3, 5], "atla": [], "label": [3, 5], "common": [], "latent": [2, 5], "space": 5, "without": [], "align": 2, "To": [0, 2, 3, 5], "get": [0, 3, 5], "start": [1, 2, 3], "check": [3, 4], "out": [1, 2, 3], "instal": [0, 1, 2, 3, 5], "guid": 3, "tutori": [0, 1, 2, 3, 4, 5], "The": [0, 1, 2, 3, 4, 5], "can": [0, 1, 2, 4, 5], "via": [0, 1, 4, 5], "pip": [0, 1, 2, 4, 5], "us": [0, 1, 2, 4, 5], "follow": [0, 1, 2, 4, 5], "command": 4, "For": [2, 4], "gpu": [0, 1, 2, 4, 5], "base": [1, 2, 4], "pytorch": 4, "we": [0, 1, 2, 4, 5], "recommend": [2, 4], "torch": 4, "portal": 4, "after": [1, 2, 4, 5], "cuda": 4, "version": [1, 4], "nvidia": 4, "smi": 4, "now": [0, 4], "you": [0, 4, 5], "ar": [0, 2, 4, 5], "all": [2, 4], "set": [0, 1, 4, 5], "how": [2, 4], "tbd": 6, "1": [0, 5], "import": [0, 1, 2, 5], "panda": [0, 1, 2, 5], "pd": [0, 1, 2, 5], "numpi": [0, 1, 2, 5], "np": [0, 1, 2, 5], "scanpi": [0, 1, 2, 5], "sc": [0, 1, 2, 5], "anndata": [0, 1, 2, 5], "dataload": [], "epi": [], "scib_metr": [], "from": [0, 1, 2, 5], "benchmark": 5, "scvi": [], "importlib": [], "epipack": [0, 2, 5], "epk": [0, 1, 2, 3, 5], "vae_vamp_gmm": [], "vae_common": [], "nethom": [0, 1, 2, 5], "ycheng430": [0, 1, 2, 5], "miniconda3": [0, 1, 2, 5], "env": [0, 1, 2, 5], "lib": [0, 1, 2, 5], "python3": [0, 1, 2, 5], "9": [0, 1, 2, 5], "site": [0, 1, 2, 5], "packag": [0, 1, 2, 3, 5], "_set": [], "py": [0, 1, 2, 5], "63": [], "userwarn": [0, 1, 5], "sinc": [1, 5], "v1": [], "0": [0, 1, 2, 5], "tool": 2, "longer": [], "random": [], "seed": [], "default": 1, "run": 0, "reproduc": [], "result": [0, 2], "previou": [], "self": [], "70": [], "dl_pin_memory_gpu_train": [], "i": [0, 1, 2, 3, 5], "deprec": [0, 1, 5], "remov": [], "pleas": [1, 5], "pass": [], "pin_memori": [], "loader": [], "instead": [], "tqdm": [1, 5], "auto": [0, 1, 2, 5], "21": [1, 5], "tqdmwarn": [1, 5], "iprogress": [1, 5], "found": [1, 2, 5], "updat": [1, 5], "jupyt": [1, 5], "ipywidget": [1, 5], "see": [1, 5], "http": [1, 5], "readthedoc": [1, 5], "io": [1, 5], "en": [1, 5], "stabl": [1, 5], "user_instal": [1, 5], "html": [1, 5], "autonotebook": [1, 5], "notebook_tqdm": [1, 5], "flax": [], "struct": [], "132": [], "futurewarn": 1, "jax": [], "tree_util": [], "register_keypath": [], "futur": [0, 1, 5], "releas": [0, 5], "register_pytree_with_kei": [], "data_clz": [], "keypath": [], "2": [0, 1, 5], "read_h5ad": [0, 5], "cerebrum_batch_1": [], "h5ad": [0, 2, 5], "compat": [], "__init__": [], "229": [], "move": [], "element": [], "un": [], "39": [0, 1, 2, 5], "neighbor": [0, 1, 5], "distanc": [], "obsp": [], "thi": [0, 1, 2, 5], "where": [], "adjac": [], "matric": [], "should": 2, "go": [], "warn": 1, "3": [0, 1, 2, 5], "x": [1, 2, 5], "raw": [1, 5], "4": [1, 2, 5], "sklearn": 0, "preprocess": [0, 2], "sp": [], "min_cel": [1, 2], "int": [1, 2, 5], "shape": [1, 2], "01": [0, 5], "pp": [0, 1, 2, 5], "filter_gen": [1, 2], "binar": [], "5": [0, 1, 2, 5], "object": [1, 2, 5], "n_ob": [1, 2], "n_var": [1, 2], "20680": [], "40174": [], "ob": [0, 2, 5], "orig": [], "ident": [], "ncount_rna": [], "nfeature_rna": [], "sample_nam": [], "donor_id": [], "day_of_pregn": [], "sex": [], "tissu": [], "total": [], "total_dedupl": [], "total_deduplicated_peak": [], "total_deduplicated_tss": [], "frip": [], "frit": [], "x_chrom_window_count": [], "y_chrom_window_count": [], "autosome_window_count": [], "blacklist_fract": [], "rna_snn_r": [], "seurat_clust": [], "ncount_peak": [], "nfeature_peak": [], "tissue_umap_1": [], "tissue_umap_2": [], "cell_typ": [], "peaks_snn_r": [], "8": [0, 1, 5], "var": [1, 2], "count": [1, 2, 5], "percentil": [], "n_cell": [], "obsm": [0, 1, 2, 5], "x_lsi": [], "x_tsne": [], "x_umap": [], "varm": [], "6": [0, 1, 5], "pretrain_peak_model": [1, 2], "ml": [0, 1, 2, 5], "peak_model": [1, 2], "count_enhanc": [1, 2], "todens": [1, 2], "z_dim": [], "50": [0, 5], "batch_siz": [], "512": [], "layer_num": [], "region_factor": [], "fals": [0, 2, 5], "model": 0, "initi": [0, 1, 2, 5], "detect": [0, 1, 2, 3, 5], "detetc": [0, 1, 2, 5], "mode": [0, 1, 2, 5], "intial": [0, 1, 2], "complet": [0, 1, 2, 5], "7": [0, 1, 2], "train_model": [0, 1, 2, 5], "nepoch": [0, 1, 2, 5], "200": [1, 2], "z": 1, "get_z": [0, 1, 2], "epipack_z_bc": 5, "detach": [1, 2], "cpu": 1, "epoch": [0, 1, 2, 5], "100": [0, 1, 2, 5], "10": [1, 2, 5], "lt": [0, 1, 2, 5], "00": [0, 1, 2, 5], "05": [1, 2], "loss_val": [1, 2], "741": [], "28": [], "n_neighbor": [0, 5], "use_rep": [0, 1, 5], "tl": [0, 1, 5], "umap": [0, 1, 5], "leiden": [0, 1, 5], "resolut": [0, 5], "pl": [0, 1, 2, 5], "color": [0, 1, 5], "ncol": [0, 5], "wspace": [0, 5], "plot": [0, 1, 5], "_tool": [0, 1, 5], "scatterplot": [0, 1, 5], "392": [0, 5], "No": [0, 1, 5], "colormap": [0, 1, 5], "provid": [0, 1, 2, 5], "c": [0, 1, 2, 5], "paramet": [0, 1, 5], "cmap": [0, 1, 5], "ignor": [0, 1, 5], "cax": [0, 1, 5], "scatter": [0, 1, 5], "celltyp": 5, "read_csv": 2, "cerebrum_batch_1_celltyp": [], "csv": 2, "list": [], "11": [0, 1, 5], "30": [], "nmi_ari_cluster_labels_leiden": [], "connect": [], "optimize_resolut": [], "true": [0, 2, 5], "n_job": [], "nmi": [], "5841662268804542": [], "ari": [], "4483450889309464": [], "31": [], "silhouette_label": [], "rescal": [], "chunk_siz": [], "256": [], "5194529201835394": [], "32": [], "clisi_knn": [], "perplex": [], "none": 1, "scale": [], "9999999829701015": [], "12": [0, 1], "dataset": [2, 5], "13": [1, 5], "peakvi_test": [], "copi": [], "14": [], "setup_anndata": [], "pvi": [], "train": [], "tpu": [], "fall": [], "back": [], "tf_cpp_min_log_level": [], "rerun": [], "more": 2, "info": [], "avail": [], "core": [0, 3, 5], "ipu": [], "hpu": [], "devic": [], "a40": [], "ha": 5, "tensor": [], "properli": [], "util": [0, 5], "them": [0, 5], "set_float32_matmul_precis": [], "medium": [], "high": [], "which": 2, "trade": [], "off": [], "precis": [], "perform": [0, 5], "detail": 2, "read": 2, "org": [], "doc": [], "gener": [0, 1, 2], "local_rank": [], "cuda_visible_devic": [], "122": [], "500": [], "24": [], "09": [], "57": 5, "89": [], "v_num": [], "train_loss_step": [], "3e": [], "train_loss_epoch": [], "02e": [], "monitor": [], "metric": [0, 2], "reconstruction_loss_valid": [], "did": [], "improv": [], "last": [], "record": [], "best": [], "5341": [], "286": [], "signal": [], "trainer": [], "stop": [], "15": 5, "peakvi_latent_kei": [], "x_peakvi": [], "get_latent_represent": [], "16": [0, 5], "17": 5, "biocon": [], "bioconserv": [], "isolated_label": [], "nmi_ari_cluster_labels_kmean": [], "18": [2, 5], "leiden_color": [], "cell_type_color": [], "27": [], "5750130693628137": [], "32586283762289403": [], "33": [], "5407780930399895": [], "43": [], "scbassset_test": [], "44": [], "chr": [], "end": 3, "var_nam": [], "split": [], "append": [], "45": [], "add_dna_sequ": [], "chr_var_kei": [], "start_var_kei": [], "end_var_kei": [], "genome_nam": [], "hg38": 2, "genome_dir": [], "work": 5, "23": [], "39it": [], "": [0, 5], "46": [], "bdata": [], "transpos": [], "layer": 1, "binari": [1, 2], "astyp": [0, 5], "float": 0, "extern": 2, "dna_code_kei": [], "dna_cod": [], "column": [], "name": [0, 2, 5], "adata": 5, "47": [], "48": [], "lightn": [], "fabric": [], "connector": [], "554": [], "support": [], "histor": [], "reason": 5, "its": 2, "usag": [], "discourag": [], "your": [], "mix": [], "rank_zero_warn": [], "16bit": [], "automat": [], "amp": [], "1000": [], "36": [0, 2, 5], "04": 2, "271": [], "266": [], "fit": [], "max_epoch": [], "reach": [], "x_scbasset": [], "51": [], "52": 1, "53": [], "502081417500375": [], "2452450043638394": [], "54": [], "46758614107966423": [], "55": [], "pca": [], "x_pca": [], "pc": [], "56": [], "write_h5ad": 2, "cerebrum_result_1028": [], "pynndesc": [0, 5], "pynndescent_": [0, 5], "358": [0, 5], "numbapendingdeprecationwarn": [0, 5], "old_styl": [0, 5], "error": [0, 5], "captur": [0, 5], "replac": [0, 5], "new_styl": [0, 5], "nn_descent_internal_low_memory_parallel": [0, 5], "370": [0, 5], "nn_descent_internal_high_memory_parallel": [0, 5], "numba": [0, 5], "function": [0, 1, 3, 5], "310": [0, 5], "use_new_style_error": [0, 5], "nearestneighbor": [], "data_c0": [], "4444x4444": [], "spars": [], "class": [], "float64": [], "gt": [], "36113": [], "store": 1, "compress": [], "row": 2, "format": [1, 2], "In": [1, 2, 5], "introduc": [1, 2], "befor": [0, 1, 2, 5], "appli": [0, 1], "10x": [1, 2], "human": 1, "pbmc": [1, 2, 5], "an": [1, 2], "exampl": [1, 2], "also": [0, 1, 2, 5], "dimens": 1, "reduct": 1, "independ": 1, "upgrad": [0, 1, 2, 5], "__version__": [0, 1, 2, 5], "0dev5": 1, "first": [1, 2, 5], "need": [1, 2, 5], "structur": 1, "file": [1, 2], "convert": [1, 2], "make_binari": [1, 2], "here": [0, 1], "directli": 1, "h5": [1, 2], "genom": [1, 2], "cellrang": 1, "peak_1": [1, 2, 5], "dt": [1, 2], "read_10x_h5": [1, 2], "pbmc_batch": [1, 2, 5], "pbmc_10k_nextgem": [1, 5], "atac_pbmc_10k_nextgem_filtered_peak_bc_matrix": 1, "variabl": 1, "9688": 1, "144023": 1, "gene_id": [1, 2], "feature_typ": [1, 2], "autoencod": [1, 2], "same": [1, 2], "filter": [1, 2], "process": [1, 2], "peakvi": [1, 2], "rare": [1, 2], "make": [0, 1, 2, 5], "faster": [1, 2], "print": [0, 1, 2, 5], "region": [1, 2], "threshold": [1, 2], "place": [1, 2], "36728": 1, "next": [0, 1, 2], "obtain": [1, 2, 5], "specif": [1, 2], "If": [1, 2], "dens": [1, 2], "input": [1, 2, 5], "03": 1, "07e": 1, "ani": 1, "other": [1, 2], "downstream": 1, "analysi": [0, 1, 3], "extract": [1, 2], "z_epipack": [1, 2], "Then": [1, 5], "test": 1, "1251": 1, "valu": 1, "na_act": 1, "categor": [1, 5], "chang": 1, "desir": 1, "avoid": 1, "color_vector": 1, "color_map": 1, "394": 1, "python": [2, 3], "includ": 3, "oor": [3, 5], "state": [3, 5], "under": 3, "diseas": 3, "perturb": 3, "condit": 3, "consist": [2, 3, 5], "three": [3, 5], "main": [3, 5], "compon": 3, "peivi": [2, 3], "queri": [0, 2, 3], "classifi": 3, "global": 3, "detector": 3, "local": 3, "variou": 3, "togeth": 2, "requir": [2, 5], "build": 2, "mappabl": 2, "subsequ": 2, "load": [0, 2, 5], "1dev4": [0, 2, 5], "either": 2, "both": [2, 5], "effici": 2, "flexibl": 2, "workflow": 2, "scatac": 2, "while": [2, 5], "archr": 2, "purpos": 2, "somewhat": 2, "lower": 2, "compar": 2, "put": 2, "r": 2, "code": [2, 5], "qualiti": 2, "control": 2, "below": [0, 2], "websit": 2, "librari": 2, "seurat": 2, "genomeinfodb": 2, "ensdb": 2, "hsapien": 2, "v86": 2, "read10x_h5": 2, "filenam": 2, "atac_pbmc_5k_nextgem_filtered_peak_bc_matrix": 2, "metadata": 2, "atac_pbmc_5k_nextgem_singlecel": 2, "header": 2, "chrom_assai": 2, "createchromatinassai": 2, "sep": 2, "fragment": 2, "atac_pbmc_5k_nextgem_frag": 2, "tsv": 2, "gz": 2, "min": 2, "featur": 2, "createseuratobject": 2, "assai": 2, "meta": 2, "getgrangesfromensdb": 2, "seqlevelsstyl": 2, "ucsc": 2, "geneact": 2, "write": 2, "t": 2, "pbmc_10k_geneact": 2, "col": 2, "genescor": 2, "snap": 2, "import_data": 2, "pbmc_5k_nextgem": [2, 5], "chrom_siz": 2, "option": 2, "sorted_by_barcod": 2, "tsse": 2, "interact": 2, "filter_cel": 2, "min_tss": 2, "min_count": 2, "5000": 2, "gene_matrix": 2, "make_gene_matrix": 2, "_core": [0, 2, 5], "121": 2, "implicitmodificationwarn": 2, "transform": 2, "str": 2, "index": 2, "4565": 2, "60606": 2, "n_fragment": 2, "frac_dup": 2, "frac_mito": 2, "step": [2, 5], "toolkit": 2, "e": 2, "g": 2, "bed": 2, "contain": 2, "ensur": 2, "guarante": 2, "barcod": 2, "those": 2, "4623": 2, "135377": 2, "between": 2, "common_cel": 2, "obs_nam": 2, "intersect": 2, "encod": [2, 5], "19": [2, 5], "38749": 2, "20": 2, "150": 2, "02": [2, 5], "55e": 2, "save": [0, 2, 5], "repeat": 2, "one": 2, "22": 2, "edit_your_path": 2, "well": 5, "each": 5, "emploi": 5, "five": 5, "design": 5, "two": 5, "peak_2": 5, "peak_3": 5, "pbmc_10k_chromiumx": 5, "peak_4": 5, "pbmc_10k_chromium_control": 5, "peak_5": 5, "pbmc_multiom": 5, "peak_6": 5, "genescore_mtx": 5, "pbmc_5b_genemtx": 5, "ref1": 5, "batch_id": 5, "ref2": 5, "ref3": 5, "ref": [0, 5], "concat": 5, "query_1": 5, "query_2": 5, "1838": [0, 5], "observ": [0, 5], "uniqu": [0, 5], "call": [0, 5], "obs_names_make_uniqu": [0, 5], "warn_names_dupl": [0, 5], "34": [0, 5], "normal": [0, 5], "express": 5, "normalize_tot": 5, "target_sum": 5, "1e4": 5, "log1p": 5, "along": 5, "concaten": 5, "procedur": 5, "across": 5, "begin": 5, "batch_cod": 5, "peak_emb": 5, "axi": [0, 5], "epk_bas": 5, "reg_mmd": 5, "reg_rec": 5, "reg_z_l2": 5, "use_batch_norm": 5, "use_layer_norm": 5, "pre_train_epoch": 5, "z_ref": [0, 5], "get_lat": 5, "val_kl_loss": 5, "96e": 5, "val_loss_z_dist": 5, "25": 5, "val_mmd": 5, "176": 5, "val_rec_loss": 5, "93e": 5, "mai": 5, "pickl": [0, 5], "modul": [0, 5], "pre": 5, "open": 5, "epk_model": 5, "pkl": 5, "wb": 5, "f": 5, "dump": 5, "rb": 5, "epi_integration_load": 5, "pretrain": 5, "creat": 5, "addit": 5, "serv": 5, "distribut": 5, "baselin": 5, "epk_queri": 5, "peivi_map": 5, "promoter_dt": 5, "enhancer_z": 5, "ref_embed": 5, "reg_mmd_int": 5, "query_model_initi": 5, "query_model": 5, "state_dict": 5, "query_batch_num": 5, "z_queri": [0, 5], "58": 5, "78": 5, "97e": 5, "0382": 5, "val_mmd_int": 5, "0511": 5, "81e": 5, "further": 5, "discov": 5, "been": 5, "curat": 5, "seaborn": [0, 5], "sn": [0, 5], "set_figure_param": [0, 5], "figsiz": [0, 5], "frameon": [0, 5], "set_them": [0, 5], "tmp": [0, 5], "z_tmp": 5, "346": 5, "init_rp_tre": 5, "dist": 5, "current_graph": 5, "leaf_arrai": 5, "348": 5, "init_random": 5, "rng_state": 5, "right": 5, "panel": 5, "cluster": 5, "remain": 5, "clearli": 5, "separ": 5, "show": 0, "tutorial_refer": 0, "tutorial_queri": 0, "suggest": 0, "labelencod": 0, "ground": 0, "truth": 0, "le": 0, "y": 0, "fit_transform": 0, "cell_type_new": 0, "clf": 0, "ref_latent_emb": 0, "ref_label": 0, "hidden_num": 0, "64": 0, "batchnorm": 0, "04it": 0, "loss_inner_v": 0, "0169": 0, "loss_inter_v": 0, "00535": 0, "predict": 0, "_": 0, "querylabel": 0, "inverse_transform": 0, "predicted_label": 0, "visual": 0, "almost": 0, "overlap": 0, "quantit": 0, "evalu": 0, "f1_score": 0, "macro": 0, "averag": 0, "micro": 0, "weight": 0, "8846567575111273": 0, "920841741135774": 0, "9215123392897806": 0, "confus": 0, "matplotlib": 0, "pyplot": 0, "plt": 0, "confusion_matrix": 0, "true_label": 0, "pred_label": 0, "cm": 0, "cm_norm": 0, "sum": 0, "newaxi": 0, "figur": 0, "heatmap": 0, "fmt": 0, "2f": 0, "gist_heat": 0, "xticklabel": 0, "yticklabel": 0, "xlabel": 0, "ylabel": 0, "titl": 0, "tight_layout": 0}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"welcom": 3, "epipack": 3, "": 3, "document": 3, "instal": 4, "guid": 4, "main": 4, "packag": 4, "tutori": 6, "cluster": 1, "peakvi": [], "scbasset": [], "lsi": [], "step": 1, "1": [1, 2], "peak": [1, 2], "pretrain": 1, "read": 1, "data": [1, 2, 5], "preprocess": 1, "model": [1, 2, 5], "train": [0, 1, 2, 5], "visual": [1, 5], "latent": 1, "space": [0, 1], "prepar": 2, "creat": 2, "gene": 2, "score": 2, "matrix": 2, "signac": 2, "snapatac2": 2, "2": 2, "embed": 2, "get": 2, "refer": 5, "map": 5, "peivi": [0, 5], "queri": 5, "option": 5, "cell": 0, "label": 0, "transfer": 0, "mappi": 0, "encod": 0, "classifi": 0}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"Step 1: Peak pretrain (clustering)": [[1, "Step-1:-Peak-pretrain-(clustering)"]], "Read data and preprocessing": [[1, "Read-data-and-preprocessing"]], "Model training": [[1, "Model-training"], [2, "Model-training"], [5, "Model-training"]], "Visualizing the latent space": [[1, "Visualizing-the-latent-space"]], "Tutorials": [[6, "tutorials"]], "Installation guide": [[4, "installation-guide"]], "Main package": [[4, "main-package"]], "Data preparation": [[2, "Data-preparation"]], "1. Create gene score matrix": [[2, "1.-Create-gene-score-matrix"]], "Signac": [[2, "Signac"]], "snapATAC2": [[2, "snapATAC2"]], "2. Create peak embedding": [[2, "2.-Create-peak-embedding"]], "get the peak embedding": [[2, "get-the-peak-embedding"]], "Reference mapping with PEIVI": [[5, "Reference-mapping-with-PEIVI"]], "Query mapping": [[5, "Query-mapping"]], "[Optional] Data visualization": [[5, "[Optional]-Data-visualization"]], "Cell label transfer on PEIVI mappiing space": [[0, "Cell-label-transfer-on-PEIVI-mappiing-space"]], "Label encoding": [[0, "Label-encoding"]], "Classifier training": [[0, "Classifier-training"]], "Welcome to EpiPack\u2019s documentation!": [[3, "welcome-to-epipack-s-documentation"]]}, "indexentries": {}})